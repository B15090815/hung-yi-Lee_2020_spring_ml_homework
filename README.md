<!--
 * @Descripttion: 
 * @version: 
 * @Author: ErCHen
 * @Date: 2020-04-25 17:52:20
 * @LastEditTime: 2020-07-19 18:43:35
 -->

# 2020春季李宏毅机器学习课后作业

## 一、课程信息

点击[链接](http://speech.ee.ntu.edu.tw/~tlkagk/courses_ML20.html) 获取更加详细的课程信息。

## [二、线性回归（作业一）](https://github.com/B15090815/hung-yi-Lee_2020_spring_ml_homework/tree/master/hw_1)

题目要求根据前9个小时的空气质量观测数据，预测第10个小时的PM2.5的值。详细题目描述及要求，点击[Kaggle链接](https://www.kaggle.com/c/ml2020spring-hw1/)获取。数据百度云盘下载[链接](https://pan.baidu.com/s/1wSRW7PURZ3DIn0r97t3qXA)，提取码：zxn0。

题目所给的数据集记录了从2014年1月到12月，每月前20天，每天24个小时18个空气质量指标的数值。具体数据描述如下图所示：

![数据描述](https://gitee.com/crxcoding/Image/raw/master/github/2020_ml_hw/hw1_data_structure.png)

本题是第一章作业，根据课程进度所涉及的知识，故采用最简单的线性模型进行学习预测。我尝试了以下两种模型的构建方式。

1. 只使用指标PM2.5的数据，忽略其余指标的影响。以连续 $n$ 小时的数据做特征，$n+1$ 小时的数据为标记，构建线性回归模型。本题要求根据连续9小时的数据预测第10小时，故这里的 $n$ 取9。

   具体到训练集构建时，记 $X_{[0,8]}$ 表示采用0时到8时这9个小时的观测值做特征，$Y_{[9]}$ 表示使用第9时的数据为标记，这样得到一个样本对 $(X_{[0,8]},Y_{[9]})$。如此一天24小时的数据可以构建15个训练样本。

    $(X_{[0,8]},Y_{[9]})$、$(X_{[1,9]},Y_{[10]})$、... $(X_{[14,22]},Y_{[23]})$

    将获得的数据，按照80%，10%，10%的比例划分训练集、交叉验证集和测试集。数据采用z-score方法进行标准化。

    PS：可以尝试不同的窗口值，即不一定选取前9个小时的数据，可以尝试不同的大小。

2. 第二个模型在第一个模型的基础上，考虑其他指标对PM2.5值的影响。首先构建每个指标的预测模型，然后构建使用其余17个指标预测PM2.5的模型。

实验结果：模型1在Kaggle公开榜上的得分为5.6274，模型2得分为14.5197。

结果分析：模型2考虑了其他指标对PM2.5的影响，在直觉上效果应该比模型1好，但实际却差了很多。自己反思了一下，将各个指标拆开预测，再用指标预测结果再去做预测，这使得误差不断累积，从而导致最后结果的恶化。

## [三、逻辑回归（作业二）](https://github.com/B15090815/hung-yi-Lee_2020_spring_ml_homework/tree/master/hw_2)

题目要求根据一些个人信息，预测一个人的收入是否超过50,000美金。详细题目描述及要求，点击[kaggle链接](https://www.kaggle.com/c/ml2020spring-hw2)，题目中数据下载，点击[百度云盘](https://pan.baidu.com/s/1e-GEi9lERqBvGDNVLQa5TA)，提取码：5cyj

题目中的数据集来源于Kaggle的Census-Income，本次作业提供了原始数据（train.csv和test_no_label.csv）和预处理过的数据（X_train 、Y_train和X_test，这个三个文件直接按照csv打开即可），其中标记规则为，超过50,000美金的为1，否则标记为0。

本题的尝试做法：

1. 直接使用510个特征进行逻辑回归预测

    - 数据预处理，去除第一列id，保留其余所有510维度属性

        **Min-Max**：对所有属性进行归一化操作，尝试所得最好预测正确率为86.32%的正确率。

        **Z-Score**：对所有属性进行归一化，尝试所得最好预测正确率为88.26%。

2. 使用含有一层的隐藏的神经网络进行预测

    隐藏层结点个数尝试设置为250、300、1020个结点，使用relu作为激活函数，分别使用Min-Max和Z-Score对数据进行标准化。可惜的是过拟合了，尝试采用正则化，但限制于电脑性能，未作过多探索，所得最好结果为87.53%（隐藏层结点数为300）。

3. 上述尝试中均使用了Momentum和学习速率衰减的策略进行优化

一点思考：使用不同的归一化方式，对训练结果有很大的影响。本题如果采用Min—Max进行归一化，实验结果很大程度上不如使用Z-Score。数据预处理阶段应注意尝试不同的归一化方式。

## [四、作业三](https://github.com/B15090815/hung-yi-Lee_2020_spring_ml_homework/tree/master/hw_3)

题目三要求利用训练一个食物分类器，可以识别常见的11类食物种类，详细题目描述及要求，点击[kaggle](https://www.kaggle.com/c/ml2020spring-hw3)获取，题目中的数据下载，点击[百度云盘](https://pan.baidu.com/s/17QGcJ3t7uoNkX4V17fAm4w)，提取码：r6ua。

本题所给的训练数据，一共包含11个类别的食物图片，并且每种类别食物的图片并不一致、图片的大小也是不一样，图片最多的类别有1500张图片，最少的仅有280张图片，最大的图片尺寸为9216×6144，最小为351×227。本题的思路为

- 数据预处理
  - 数据倍增（Data Augmentation）

    1500为每个类别的训练样本数，对于少于1500张图片的类别采取差额补充，具体做法为：从每个类别中又放回的抽取差额数量的图片，对每张图片等概率的进行一下四种变换：左旋30度、右旋30度、上下翻转、左右翻转。
  - 图片尺寸归一化

    每张图片大小不一致，强行对图片进行缩放，考虑到电脑性能，将图片统一缩放到128×128的尺寸。
  - 图片转numpy数组

    将图片的RGB像素矩阵除以255，将像素值归一化到0~1。

- 构建CNN网络
  本题构建的网络结构如图所示。

    ![CNN网络结构](https://gitee.com/crxcoding/Image/raw/master/github/2020_ml_hw/hw3_cnn_structure.png)
